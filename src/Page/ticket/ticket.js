//Ë¥≠Á•®‰∏≠ÂøÉ
import { useEffect, useRef, useState } from "react";
import Bread4 from '../../Public/4breadcrumb'
import 'antd/dist/antd.css';
import { Layout,Row, Col,Button} from 'antd';
import { Tabs } from 'antd';
import {PhoneOutlined} from '@ant-design/icons';
import Anchorpoint from '../../Public/anchor-point';
import axios from 'axios';
import Stickets from '../../Public/tickets'

const { Header, Footer, Sider, Content } = Layout;
const  {TabPane} = Tabs;
const style = { padding: '8px 0',textAlign:'center'};

const callback=(key)=>{
    console.log(key);
}
export default function  ticket(props) {

    const [name,setName] = useState('Êú™ÁôªÂΩï');
    let [num,setNum] = useState(667708);
    const [url,setUrl] = useState('https://avatars.githubusercontent.com/u/');
    const [identification,setIdentification]=useState('');

    const [moviename,setMoviename] = useState('‰Ω†Â•Ω‰∏ñÁïå');
    const [url2,setUrl2] = useState('https://img.daeyes.com.cn:8081/uploads/images/Film/25adf535-6b55-4116-8dd9-dedeb84e57ee/20210520091242.jpg');
    const [director,setDirector] =new useState('Âº†Ê≥ΩÊòÜ');
    const [star,setStar] =new useState('Âº†Âì•');
    const [type,setType] = new useState('2D/3D')
    const [duration,setDuration] = new useState('100ÂàÜÈíü');
    const [text,setText] = new useState('Âú®‰∫¨ÈÉΩÂ±Ö‰ΩèÁöÑÂÜÖÂêëÁî∑È´ò‰∏≠ÁîüÁõ¥ÂÆûÔºàÂåóÊùëÂå†Êµ∑ ÈÖçÈü≥ÔºâÁöÑÈù¢ÂâçÔºåÁ™ÅÁÑ∂Âá∫Áé∞‰ªé10Âπ¥ÂêéÁ©øË∂äËÄåÊù•26Â≤ÅÁöÑËá™Â∑±ÔºàÊùæÂùÇÊ°ÉÊùé ÈÖçÈü≥Ôºâ„ÄÇÊú™Êù•ÁöÑÁõ¥ÂÆûÂëäËØâ‰ªñÔºåËá™Â∑±‰∏ç‰πÖ‰æø‰ºö‰∏éÁêâÁíÉÔºàÊª®ËæπÁæéÊ≥¢ ÈÖçÈü≥ÔºâÁõ∏Áà±ÔºåÂèØÊòØ‰πãÂêéÁÉüËä±Â§ß‰ºöÊó∂Â•πÂç¥‰ºöÂõ†‰∏∫‰∏ÄÂú∫‰∫ãÊïÖÊÑèÂ§ñÁ¶ª‰∏ñ„ÄÇ‰∏∫‰∫ÜÊãØÊïëÁà±‰∫∫Ôºå16Â≤ÅÁöÑÁõ¥ÂÆûÂç∑ÂÖ•‰∫ÜËøôÂú∫Áé∞ÂÆû‰∏éËôöÊãüÁöÑËÆ∞ÂøÜ‰∏ñÁïåÔºåÁªèÂéÜ‰∫Ü‰∏ÄÁ≥ªÂàóË∂Ö‰πéÊÉ≥Ë±°ÁöÑ‰∫ãÊÉÖ„ÄÇÂç≥‰Ωø‰∏ñÁïåÊØÅÁÅ≠ÔºåÊàë‰πüÊÉ≥ÂÜçËßÅ‰Ω†‰∏ÄÈù¢„ÄÇ');
 
    useEffect(
        ()=>{
            if(props.location.state !== undefined){
                 if(props.location.state.username === 'undefined'){
                      alert('‰Ω†ËøòÊú™ÁôªÂΩïÔºÅËØ∑ÂÖàÁôªÂΩïÔºÅ');
                      props.history.push('/');
                 }
                 console.log(props.location.state);
                 setName(()=>{
                         return props.location.state.username;
                 });
                 setNum(()=>{return props.location.state.headPortrait;});
                 setIdentification(()=>{return props.location.state.identification;}); 
            }
            return;
        }
        ,[]);

     useEffect(()=>{
          if(props.location.state !== undefined){
               if(props.location.state.moviename !== undefined){
                    setMoviename(props.location.state.moviename);
              }
              if(props.location.state.username !==undefined && props.location.state.moviename ===undefined){
                   props.location.state.moviename=moviename;
              }
               if(props.location.state.url2 !== undefined){
                     setUrl2(props.location.state.url2);
               }else{
                    props.location.state.url2=url2;
               }

               if(props.location.state.director !== undefined){
                    setDirector(props.location.state.director);
               }
          }
     },[]);

     const Search=(e)=>{
      if(e.keyCode === 13){
          console.log('ÊêúÂΩ±ÁâáÔºÅ');
          console.log(e.target.value);
          let post1={
              username:name,
              moviename:e.target.value
          }
          console.log(post1);
          axios.post('http://localhost:3017/search/movie',post1)
          .then((res)=>{
            console.log(res);
            if(res.data === 'Ê≤°ÊúâÊêúÂà∞‰Ω†Ë¶ÅÁöÑÂΩ±Áâá!'){
                 alert('Ê≤°ÊúâÊêúÁ¥¢Âà∞‰Ω†ÊÉ≥Ë¶ÅÁöÑÂΩ±ÁâáÔºÅ');
            }else if(res.data === '‰Ω†ËøòÊú™ÁôªÂΩï!'){
                 alert('‰Ω†ËøòÊ≤°ÊúâÁôªÂΩïÔºÅËØ∑ÁôªÂΩïÂêéÂÜçËøõË°åÊìç‰ΩúÔºÅ');
            }
            else{
              console.log('ÊêúÂà∞‰Ω†ÊÉ≥Ë¶ÅÁöÑÂΩ±ÁâáÂï¶!');
              setMoviename(res.data.moviename);  
              setUrl2(res.data.movieurl);
              setDirector(res.data.moviedirector);
                props.history.push({pathname:'/ticket-center',state:{username:name,
                headPortrait:num,
                identification:props.location.state.identification,
                moviename:res.data.moviename,
                url2:res.data.movieurl,
                director:res.data.moviedirector}});
                console.log('Ë¢´Â±èËîΩ‰∫ÜÂêó!');
               
            }

          }).catch((err)=>{
            console.log(err);
          })
      }
}
       
      useEffect(()=>{
            console.log('ÂΩ±ÁâáÊ¶ÇËø∞Ôºö'+props.location.state.moviedescribe)
          if(props.location.state.moviedescribe !== undefined){
                 setText(props.location.state.moviedescribe);
          }
      },[])

      return(
          <>
            <Layout>
             <Header style={{backgroundColor:'white',boxShadow:'1px 4px 8px 3px rgba(0,0,0,0.2)'}}>
             <Row>
                <Col span={4} style={{height:'64px',lineHeight:'64px'}}>
                      <h2>üêüÊ∞¥ÂΩ±Èô¢(‚âß‚àá‚â¶)Ôæâ</h2>
                      <span style={{position:'relative',top:'-55px'}}>‰∏ç Ë¥ü Â•Ω Êó∂ ÂÖâ</span>
                </Col>
                <Col span={4} style={{height:'100%'}}>
                      
                </Col>
                <Col span={4} style={{height:'100%'}}>
                      
                </Col>
                <Col span={3} style={{height:'100%'}}>
                      
                </Col>
                <Col span={4} style={{display:'inline-block',lineHeight:'64px',height:'64px'}}>
                <input onKeyDown={Search} style={{height:'60%'}} placeholder='ÊêúÁ¥¢ÂΩ±Áâá...'></input>
                </Col>
                <Col span={2} style={{height:'64px',lineHeight:'64px',overflow:'hidden'}}>
                      <a style={{paddingLeft:'20px'}} onClick={()=>{props.history.push('/customer/service')}}>ÂÆ¢Êúç</a>
                </Col>
                <Col span={3} style={{height:'64px',lineHeight:'64px',verticalAlign:'middle',position:'relative',overflow:'hidden'}}>
                   <span style={{lineHeight:'64px',textAlign:'center',height:'64px',width:'80px',borderBottom:'2px solid #40a9ffb5',
                   position:'absolute',zIndex:'1000',left:'20px'}}>
                        {name}
                   </span>
                   <div style={{overflow:'hidden',textAlign:'center',lineHeight:'64px',
                    overflow:'hidden',position:'absolute',right:'5px',height:'64px',
                     width:'64px',borderRadius:'32px',backgroundColor:'hsl(0deg 0% 62% / 10%)'}}>
                     <img style={{width:'100%',height:'100%'}} alt='Â§¥ÂÉè'  src={url+num}></img>
                   </div>
                </Col>
               </Row>
               <Anchorpoint/>
             </Header>
             <Content style={{width:'100%',height:'1500px'}}>
                     <Bread4 state={{username :props.location.state === undefined ? '' : props.location.state.username,
                                     headPortrait : props.location.state.headPortrait,
                                     identification : props.location.state.identification,}}
                             breadcrumbName1={{path: '/home',breadcrumbName: 'üè†ÂΩ±ËßÜÂ§ßÂéÖ'}}
                             breadcrumbName2={{path: '/ticket-center',breadcrumbName: 'Ë¥≠Á•®‰∏≠ÂøÉ>'}}/>
                     <div style={{marginTop:'5px'}}>
                     <Row>
                          <Col span={5}  style={{height:'400px'}}>
                              <img src={url2} style={{width:'100%',height:'100%'}} alt='ÁΩëÁªúÂç°È°øÊàñËµÑÊ∫êË∑ØÂæÑÂ§±Êïà'></img>
                          </Col>
                          <Col span={12}  style={{height:'400px'}}>
                                <div style={{marginLeft:'15px',marginTop:'10px',fontSize:'22px',padding:'18px 0px'}}>{moviename}</div>
                                <h4 style={{color:'#1ba4e5',marginLeft:'15px',padding:'18px 0px',borderBottom:'1px solid #bababacc'}}>ÂØºÊºîÔºö<span style={{color:'black',fontSize:'15px'}}>{director}</span></h4>
                                <h4 style={{color:'#1ba4e5',marginLeft:'15px',padding:'18px 0px',borderBottom:'1px solid #bababacc'}}>‰∏ªÊºîÔºö<span style={{color:'black',fontSize:'15px'}}>{star}</span></h4>
                                <h4 style={{color:'#1ba4e5',marginLeft:'15px',padding:'18px 0px',borderBottom:'1px solid #bababacc'}}>Á±ªÂûãÔºö<span style={{color:'black',fontSize:'15px'}}>{type}</span></h4>
                                <h4 style={{color:'#1ba4e5',marginLeft:'15px',padding:'18px 0px',borderBottom:'1px solid #bababacc'}}>ÁâáÈïøÔºö<span style={{color:'black',fontSize:'15px'}}>{duration}</span></h4>             
                          </Col>
                          <Col span={6}  style={{marginLeft:'10px',height:'400px'}}>
                                <div style={{borderBottom:'',color:'#1ba4e5',fontSize:'26px',lineHeight:'79.09px',textAlign:'center',marginTop:'60px',height:'79.09px'}}>
                                    <PhoneOutlined/>400-687-0707
                                </div>
                                <div style={{backgroundColor:'#9e9e9e12',borderTop:'1px solid #9e9e9e69',fontSize:'15px',lineHeight:'60px',textAlign:'center',height:'60px'}}>
                                      Âë®‰∏ÄËá≥Âë®Â§© 09:00 ~ 20:00
                                </div>
                          </Col>
                     </Row>
                  
                   </div>
                   <Tabs defaultActiveKey="1" onChange={callback} style={{backgroundColor:'#f6f6f6',width:'71%'}}>
                      <TabPane tab="ÊéíÁâáË¥≠Á•®" key="1">
                          <Stickets url='https://img.daeyes.com.cn:8081/uploads/images/Cinema/11140641/11140641.jpg' moviename2='1+xÁîµÂΩ±ÁîüÊ¥ªÁ©∫Èó¥‰ªäÂÖ∏Ëä±Âõ≠Â∫óÔºàÂéü17.5ÂΩ±ÂüéÔºâ'  language='ÂõΩËØ≠' office='6Âè∑ÂéÖ(ÊøÄÂÖâÂéÖ)'/>
                          <Stickets url='https://img.daeyes.com.cn:8081/uploads/images/Cinema/11080961/11080961.jpg' moviename2='ËæâÁÖåÂΩ±‰∏ö‰ªäÂÖ∏Ëä±Âõ≠Â∫óÔºàÂéü17.6ÂΩ±ÂüéÔºâ' language='Ê≥ïËØ≠' office='9Âè∑ÂéÖ'/>
                          <Stickets url='https://img.daeyes.com.cn:8081/uploads/images/Cinema/11066701/11066701.jpg' moviename2='ÊûÅÈôêÂΩ±‰∏ö‰ªäÂÖ∏Ëä±Âõ≠Â∫óÔºàÂéü17.7ÂΩ±ÂüéÔºâ' language='Âæ∑ËØ≠' office='10Âè∑ÂéÖ'/>
                          <Stickets url='https://img.daeyes.com.cn:8081/uploads/images/Cinema/11060721/11060721.jpg' moviename2='‰∏áËææÂΩ±ËßÜ‰ªäÂÖ∏Ëä±Âõ≠Â∫óÔºàÂéü17.8ÂΩ±ÂüéÔºâ' language='ÂõΩËØ≠' office='11Âè∑ÂéÖ'/>
                         
                      </TabPane>
                      <TabPane tab="ÂΩ±ËßÜËØ¶ÊÉÖ" key="2" style={{height:'100px'}}>
                              <span>
                                     {text}
                              </span>
                      </TabPane>
                      <TabPane tab="È¢ÑÂëäÁâá" key="3" style={{textAlign:'center',height:'100px',lineHeight:'100px'}}>
                                  <span >‰∫≤ÔºÅÊöÇÊó∂Ê≤°ÊúâÈ¢ÑÂëäÁâáÔºåËØ∑Á®çÂêéÂÜçËØïÔºÅ</span>
                      </TabPane>
                   </Tabs>
                   <div style={{marginLeft:'10px',height:'1011px',width:'379.300px',position:'absolute',right:'54px',top:'491px'}}>
                        <span style={{display:'inline-block',fontSize:'20px',marginBottom:'4px'}}>ÁÉ≠Êò†ÂΩ±ÁâáÊéíË°åÊ¶ú</span>
                        <div style={{position:'relative',width:'100%',height:'154px',marginBottom:'10px'}}>
                              <img style={{width:'120px',height:'100%'}} src='https://img.daeyes.com.cn:8081/uploads/images/Film/830d1dd8-a09c-47de-98b7-23465356eee3/20210601085827.jpg'></img>
                              <p style={{display:'inline-block',marginLeft:'13px'}}>
                                <h3>ÁÉ≠Â∏¶ÂæÄ‰∫ã</h3>
                                <span style={{fontSize:'10px',color:'#999'}}>ÂØºÊºîÔºöÊ∏©‰ªïÂüπ</span><br></br>
                                <span style={{fontSize:'10px',color:'#999'}}>184ÂÆ∂ÂΩ±Èô¢‰∏äÊò†1782Âú∫</span>
                                <p style={{position:'absolute',bottom:'-14px'}}><Button  style={{borderRadius:'5px'}} type="primary">ÈÄâÂ∫ßË¥≠Á•®</Button></p>
                              </p>
                        </div>
                        <div style={{position:'relative',width:'100%',height:'154px',marginBottom:'10px'}}>
                              <img style={{width:'120px',height:'100%'}} src='https://img.daeyes.com.cn:8081/uploads/images/Film/25adf535-6b55-4116-8dd9-dedeb84e57ee/20210520091242.jpg'></img>
                              <p style={{display:'inline-block',marginLeft:'13px'}}>
                                <h3>‰Ω†Â•Ω‰∏ñÁïå</h3>
                                <span style={{fontSize:'10px',color:'#999'}}>ÂØºÊºîÔºö‰ºäËó§Êô∫ÂΩ¶</span><br></br>
                                <span style={{fontSize:'10px',color:'#999'}}>169ÂÆ∂ÂΩ±Èô¢‰∏äÊò†1253Âú∫</span>
                                <p style={{position:'absolute',bottom:'-14px'}}><Button  style={{borderRadius:'5px'}} type="primary">ÈÄâÂ∫ßË¥≠Á•®</Button></p>
                              </p>
                        </div>
                        <div style={{position:'relative',width:'100%',height:'154px',marginBottom:'10px'}}>
                               <img style={{width:'120px',height:'100%'}} src='https://img.daeyes.com.cn:8081/uploads/images/Film/b527398d-b46a-4084-9ff0-a34a110119db/20210525091819.jpg'></img>
                              <p style={{display:'inline-block',marginLeft:'13px'}}>
                                <h3>Â§©Â†ÇÁîµÂΩ±Èô¢</h3>
                                <span style={{fontSize:'10px',color:'#999'}}>ÂØºÊºîÔºöÊú±Â°û‰Ω©¬∑ÊâòÁ∫≥Â§öÈõ∑</span><br></br>
                                <span style={{fontSize:'10px',color:'#999'}}>184ÂÆ∂ÂΩ±Èô¢‰∏äÊò†1782Âú∫</span>
                                <p style={{position:'absolute',bottom:'-14px'}}><Button  style={{borderRadius:'5px'}} type="primary">ÈÄâÂ∫ßË¥≠Á•®</Button></p>
                              </p>
                        </div>
                        <div style={{position:'relative',width:'100%',height:'154px',marginBottom:'10px'}}>
                              <img style={{width:'120px',height:'100%'}} src='https://img.daeyes.com.cn:8081/uploads/images/Film/e26c6218-c518-4ca4-be7d-0515323918c0/20210508140837.jpg'></img>
                              <p style={{display:'inline-block',marginLeft:'13px'}}>
                                <h3>ÈÄüÂ∫¶‰∏éÊøÄÊÉÖ9</h3>
                                <span style={{fontSize:'10px',color:'#999'}}>ÂØºÊºîÔºöÊûóËØ£ÂΩ¨</span><br></br>
                                <span style={{fontSize:'10px',color:'#999'}}>184ÂÆ∂ÂΩ±Èô¢‰∏äÊò†1782Âú∫</span>
                                <p style={{position:'absolute',bottom:'-14px'}}><Button  style={{borderRadius:'5px'}} type="primary">ÈÄâÂ∫ßË¥≠Á•®</Button></p>
                              </p>  
                        </div>
                        <div style={{position:'relative',width:'100%',height:'154px',marginBottom:'10px'}}>
                              <img style={{width:'120px',height:'100%'}} src='https://img.daeyes.com.cn:8081/uploads/images/Film/989b0ca1-264a-4047-9b50-49654089c5fb/20210402093901.jpg'></img>
                              <p style={{display:'inline-block',marginLeft:'13px'}}>
                                <h3>ÊÇ¨Â¥ñ‰πã‰∏ä</h3>
                                <span style={{fontSize:'10px',color:'#999'}}>ÂØºÊºîÔºöÂº†Ëâ∫Ë∞ã</span><br></br>
                                <span style={{fontSize:'10px',color:'#999'}}>125ÂÆ∂ÂΩ±Èô¢‰∏äÊò†703Âú∫</span>
                                <p style={{position:'absolute',bottom:'-14px'}}><Button  style={{borderRadius:'5px'}} type="primary">ÈÄâÂ∫ßË¥≠Á•®</Button></p>
                              </p>
                        </div>
                        <div style={{position:'relative',width:'100%',height:'154px',marginBottom:'10px'}}>
                              <img style={{width:'120px',height:'100%'}} src='https://img.daeyes.com.cn:8081/uploads/images/Film/830d1dd8-a09c-47de-98b7-23465356eee3/20210601085827.jpg'></img>
                              <p style={{display:'inline-block',marginLeft:'13px'}}>
                                <h3>ÁÉ≠Â∏¶ÂæÄ‰∫ã</h3>
                                <span style={{fontSize:'10px',color:'#999'}}>ÂØºÊºîÔºöÊ∏©‰ªïÂüπ</span><br></br>
                                <span style={{fontSize:'10px',color:'#999'}}>184ÂÆ∂ÂΩ±Èô¢‰∏äÊò†1782Âú∫</span>
                                <p style={{position:'absolute',bottom:'-14px'}}><Button  style={{borderRadius:'5px'}} type="primary">ÈÄâÂ∫ßË¥≠Á•®</Button></p>
                              </p>
                        </div>
                   </div>

                      
             </Content>
             <Footer style={{backgroundColor:'#fff',borderTop:'1px solid back',position:'relative'}}>
               <h5 style={{position:'absolute',top:'18px'}}>üêüÊ∞¥ÂΩ±Èô¢</h5>   
               <h5 style={{position:'absolute',right:'40px',top:'18px'}}>ËÅîÁ≥ªÊñπÂºèÔºö110</h5>
               <h5 style={{position:'absolute',top:'40px'}}>ÊÄªÁªèÁêÜÔºöÂº†Ê≥ΩÊòÜ</h5>    
               <h5 style={{position:'absolute',top:'60px'}}>Â§áÊ≥®Ôºö‰∏≠ÂõΩÈôïË•øÁúÅÂí∏Èò≥Â∏ÇÂÖ¥Âπ≥Â∏ÇËÇ≤ÊâçË∑Ø</h5>
             </Footer>
        </Layout>
          </>
      );

}